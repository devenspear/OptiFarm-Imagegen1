{% extends "base.html" %}

{% block title %}Characters - Optimist Farm Generator{% endblock %}

{% block content %}
<div class="space-y-6">
    <div class="flex justify-between items-center">
        <div>
            <h1 class="text-3xl font-bold text-gray-800 dark:text-gray-100">Characters</h1>
            <p class="text-gray-600 dark:text-gray-400">{{ characters|length }} characters from Writing Bible v2.4</p>
        </div>
        <a href="/generate" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
            Generate Hero Shots â†’
        </a>
    </div>

    <!-- Role Filter -->
    <div class="flex gap-2">
        <button onclick="filterCharacters('all')" class="filter-btn active px-4 py-2 bg-gray-800 dark:bg-gray-100 text-white dark:text-gray-800 rounded-full text-sm" data-filter="all">All</button>
        <button onclick="filterCharacters('core')" class="filter-btn px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" data-filter="core">Core (9)</button>
        <button onclick="filterCharacters('friend')" class="filter-btn px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" data-filter="friend">Friends (7)</button>
        <button onclick="filterCharacters('mentor')" class="filter-btn px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" data-filter="mentor">Mentor (1)</button>
        <button onclick="filterCharacters('special')" class="filter-btn px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-300 dark:hover:bg-gray-600" data-filter="special">Special (1)</button>
    </div>

    <!-- Characters Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="characters-grid">
        {% for char in characters %}
        <div class="char-card bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden card-hover transition" data-role="{{ char.role }}">
            <div class="rainbow-gradient h-2"></div>
            <div class="p-6">
                <div class="flex items-start justify-between mb-4">
                    <div class="flex items-center">
                        <div class="w-14 h-14 bg-gradient-to-br from-farm-yellow to-farm-orange dark:from-amber-600 dark:to-orange-600 rounded-full flex items-center justify-center text-2xl mr-4">
                            {% if char.role == 'mentor' %}ğŸ¦‰
                            {% elif 'bunny' in char.id %}ğŸ°
                            {% elif 'pig' in char.id %}ğŸ·
                            {% elif 'goat' in char.id %}ğŸ
                            {% elif 'cow' in char.id %}ğŸ„
                            {% elif 'lamb' in char.id %}ğŸ‘
                            {% elif 'dog' in char.id %}ğŸ•
                            {% elif 'chick' in char.id %}ğŸ¤
                            {% elif 'duck' in char.id %}ğŸ¦†
                            {% elif 'donkey' in char.id %}ğŸ«
                            {% elif 'squirrel' in char.id %}ğŸ¿ï¸
                            {% elif 'mouse' in char.id %}ğŸ­
                            {% elif 'horse' in char.id %}ğŸ´
                            {% elif 'rooster' in char.id %}ğŸ“
                            {% elif 'snail' in char.id %}ğŸŒ
                            {% else %}ğŸ¾
                            {% endif %}
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800 dark:text-gray-100 text-lg">{{ char.name }}</h3>
                            <span class="text-xs font-medium px-2 py-1 rounded-full capitalize
                                {% if char.role == 'core' %}bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300
                                {% elif char.role == 'friend' %}bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300
                                {% elif char.role == 'mentor' %}bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300
                                {% else %}bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-300{% endif %}">
                                {{ char.role }}
                            </span>
                        </div>
                    </div>
                </div>

                <p class="text-gray-600 dark:text-gray-400 text-sm mb-4">{{ char.description }}</p>

                <div class="space-y-2 text-sm">
                    <div>
                        <span class="font-medium text-gray-700 dark:text-gray-300">Personality:</span>
                        <span class="text-gray-500 dark:text-gray-400">{{ char.personality }}</span>
                    </div>
                    <div>
                        <span class="font-medium text-gray-700 dark:text-gray-300">Visual Cues:</span>
                        <span class="text-gray-500 dark:text-gray-400">{{ char.visual_cues }}</span>
                    </div>
                    <div class="flex flex-wrap gap-1 mt-2">
                        {% for virtue in char.virtues %}
                        <span class="virtue-badge text-white text-xs px-2 py-1 rounded capitalize">{{ virtue }}</span>
                        {% endfor %}
                    </div>
                </div>

                <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 flex justify-between items-center">
                    <code class="text-xs bg-gray-100 dark:bg-gray-700 dark:text-gray-300 px-2 py-1 rounded">{{ char.id }}</code>
                    <a href="/generate?character={{ char.id }}" class="text-blue-500 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 text-sm font-medium">
                        Generate â†’
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
function filterCharacters(role) {
    const cards = document.querySelectorAll('.char-card');
    const buttons = document.querySelectorAll('.filter-btn');

    buttons.forEach(btn => {
        btn.classList.remove('active', 'bg-gray-800', 'dark:bg-gray-100', 'text-white', 'dark:text-gray-800');
        btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
    });

    event.target.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
    event.target.classList.add('active', 'bg-gray-800', 'dark:bg-gray-100', 'text-white', 'dark:text-gray-800');

    cards.forEach(card => {
        if (role === 'all' || card.dataset.role === role) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
}
</script>
{% endblock %}
